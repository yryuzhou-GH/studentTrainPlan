# 学生培养计划可视化系统

一个集培养计划可视化、智能课程推荐、选课管理、课程难度评分、AI助手、论坛讨论为一体的现代化教学辅助平台，帮助学生掌握个人学业进度，促进学习交流，也便于管理员集中维护学生数据。

## ✨ 功能概览

### 🎯 核心功能

- **🏠 优化首页**：展示学生当前学习状态、课程进度概览，信息密度高，功能实用性强
- **📊 可视化培养计划树**：树形结构展示培养计划，实时统计学分完成情况，支持交互式进度管理
- **🎯 智能课程推荐**：基于协同过滤的动态推荐系统，个性化推荐专业选修课程，支持相似学生推荐
- **⭐ 课程难度评分**：多维度课程难度评分系统（整体/理论/实践/作业），帮助学生了解课程难度
- **📚 选课中心**：支持按课程号/名称搜索，多条件筛选（学院/类型/学分/时间），选课/退课管理，时间冲突检测
- **🤖 AI 学习助手**：基于 DeepSeek API 的智能问答助手，解答学习问题，提供学习建议
- **💬 课程论坛**：发布话题、参与讨论、话题排序筛选（最新/回复最多/我的参与）、热门话题、教师回复标识
- **📈 课程进度管理**：进度总览（总课程数/已完成/进行中/待完成），详情列表（周次/进度条/状态），进度同步到首页
- **👤 个人中心**：左右布局设计，个人信息卡片、学习状态概览、系统功能提示，支持编辑资料和头像上传
- **📬 消息中心**：系统公告和通知管理，支持筛选、排序、搜索，个性化消息推送
- **🔧 管理员功能**：维护学生基础信息、发布系统公告、管理课程数据

### 🚀 推荐系统特性

- **动态推荐**：每次推荐都重新加载最新选课数据，确保推荐结果实时更新
- **多策略融合**：
  - 协同过滤推荐（基于用户相似度）
  - 冷启动推荐（新同学基于专业的热门课程）
  - 热门课程推荐（回退策略）
- **相似学生推荐**：推荐志同道合的朋友，基于选课偏好相似度
- **专业匹配**：优先推荐学生专业相关的选修课程
- **智能回退**：多层次推荐策略，确保总能返回有价值的推荐结果

### 🌟 用户体验优化

- **响应式设计**：适配不同屏幕尺寸，支持移动端访问
- **实时反馈**：操作成功/失败消息提示，加载状态显示
- **错误处理**：完善的错误处理机制，友好的错误提示
- **兼容性优化**：支持多种浏览器，向下兼容旧版本

> 📖 详细的推荐系统机制说明请查看 [课程推荐机制说明.md](./课程推荐机制说明.md)

## 🛠️ 技术栈

### 后端技术
- **Python 3.8+**：主要开发语言
- **Flask 2.0+**：轻量级Web框架，提供RESTful API
- **NumPy**：数值计算和矩阵运算，用于推荐算法
- **PyMySQL**：MySQL数据库连接和操作
- **OpenAI Client**：DeepSeek API调用（AI助手功能）

### 前端技术
- **HTML5 + CSS3 + JavaScript**：现代Web标准
- **jQuery 1.12.4**：DOM操作和AJAX请求，兼容性优化
- **ECharts 5.0+**：数据可视化图表（课程推荐、进度统计）
- **Bootstrap 4.0+**：响应式UI框架
- **Font Awesome**：图标库

### 数据库
- **MySQL 5.7+**：关系型数据库（必须使用 `utf8mb4` 字符集）
- **数据表**：学生信息、课程信息、选课记录、评分数据等

### 开发工具
- **Git**：版本控制
- **VS Code**：推荐开发环境
- **Chrome DevTools**：前端调试

## 📦 环境要求与依赖安装

### 系统要求
- **Python**: 3.8 或更高版本
- **MySQL**: 5.7 或更高版本
- **浏览器**: Chrome 60+, Firefox 55+, Safari 12+, Edge 79+

### Python依赖包
```bash
# 核心依赖
pip install Flask>=2.0.0
pip install numpy>=1.19.0
pip install pymysql>=1.0.0

# AI助手功能（可选）
pip install openai>=1.0.0

# 或者一次性安装所有依赖
pip install Flask numpy pymysql openai
```

### 数据库要求
- MySQL服务器运行中
- 支持utf8mb4字符集
- 具有创建数据库和表的权限

## 🚀 快速开始

### 1. 克隆项目

```bash
git clone https://github.com/gsolvit/studentTrainPlan.git
cd studentTrainPlan
```

### 2. 数据库初始化

**重要**：必须使用 `utf8mb4` 字符集，防止中文插入报错。

```sql
# 连接MySQL
mysql -u root -p

# 设置字符集
SET NAMES utf8mb4;
SET CHARACTER SET utf8mb4;

# 创建数据库
DROP DATABASE IF EXISTS studenttrainplan;
CREATE DATABASE studenttrainplan CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE studenttrainplan;

# 导入数据表结构和基础数据
SOURCE sql/schema.sql;
SOURCE sql/insert_student.sql;
SOURCE sql/insert_loginformation.sql;
SOURCE sql/insert_education_plan.sql;
SOURCE sql/insert_choose.sql;
SOURCE sql/insert_edu_stu_plan.sql;

# 创建课程难度评分表（新功能）
SOURCE sql/create_difficulty_rating_table.sql;
```

> ⚠️ **常见问题解决**：
> - 如果遇到 `Data too long` 或 `Incorrect string value` 错误：
>   1. 确认已执行 `SET NAMES utf8mb4;` 和 `SET CHARACTER SET utf8mb4;`
>   2. 确保SQL文件保存为UTF-8编码
>   3. 检查数据库和表都使用 `utf8mb4` 字符集
> - 如果导入失败，请检查MySQL用户权限和文件路径

### 3. 配置数据库连接

编辑 `config.py`：

```python
config = {
    'default': Config,
    'MYSQL_PASSWORD': '你的MySQL密码',  # 修改为你的MySQL密码
    'DATABASE_NAME': 'studenttrainplan'
}
```

### 4. AI助手配置（可选）

如果需要使用AI助手功能，需要配置DeepSeek API密钥：

**Windows (CMD):**
```cmd
set DEEPSEEK_API_KEY=your_api_key_here
```

**Windows (PowerShell):**
```powershell
$env:DEEPSEEK_API_KEY="your_api_key_here"
```

**Linux/Mac:**
```bash
export DEEPSEEK_API_KEY=your_api_key_here
```

**永久设置（推荐）:**
- Windows: 在系统环境变量中添加 `DEEPSEEK_API_KEY`
- Linux/Mac: 在 `~/.bashrc` 或 `~/.zshrc` 中添加 export 语句

> 💡 **说明**：
> - 如果不配置API密钥，AI助手功能将不可用，但不影响其他功能
> - 可以从 [DeepSeek官网](https://platform.deepseek.com/) 获取API密钥
> - 首次使用可能需要充值或申请免费额度

### 5. 启动应用

```bash
# 进入项目目录
cd studentTrainPlan

# 启动Flask应用
python main.py
```

**启动成功后会看到类似输出：**
```
 * Running on http://127.0.0.1:5000
 * Debug mode: on
```

**访问应用：**
- 浏览器打开 [http://localhost:5000](http://localhost:5000)
- 或者 [http://127.0.0.1:5000](http://127.0.0.1:5000)

> 🔧 **开发模式说明**：
> - 默认启动在调试模式，代码修改后自动重启
> - 生产环境部署请参考 [部署说明](#-部署) 章节

## 👤 默认账号

### 管理员账号
| 账号 | 密码 | 权限 | 说明 |
| ---- | ---- | ---- | ---- |
| `admin` | `123456` | 超级管理员 | 学生信息增删改、系统公告发布 |

### 学生测试账号
| 账号 | 密码 | 角色 | 说明 |
| ---- | ---- | ---- | ---- |
| `3016216097` | `3016216097` | 学生 | 完整选课数据，适合测试推荐功能 |
| `3016216098` | `3016216098` | 学生 | 部分选课数据，适合测试冷启动推荐 |
| `3016216099` | `3016216099` | 学生 | 新学生，适合测试新用户体验 |

> 📝 **说明**：
> - **管理员登录**：自动跳转到 `/manager` 管理页面
> - **学生登录**：进入首页，可访问所有学生功能模块
> - **其他学生账号**：密码均为对应的学号
> - **测试建议**：使用不同账号测试不同场景的推荐效果

## 📁 项目结构

```
studentTrainPlan/
├── main.py                    # Flask应用入口，路由定义
├── config.py                  # 配置文件（数据库连接等）
├── errors.py                  # 错误处理模块
├── seed_data.py              # 数据库初始化脚本
├── test_db_connection.py     # 数据库连接测试
├── utils/                     # 工具模块
│   ├── __init__.py           # 包初始化
│   ├── query.py              # 数据库查询工具
│   ├── dynamic_recommend.py  # 动态课程推荐系统
│   ├── course_selection.py   # 选课功能模块
│   ├── recommed_module.py    # 旧版推荐模块（SVD算法备用）
│   ├── map_student_course.py # 学生-课程映射工具
│   ├── broadcast.py          # 公告广播功能
│   ├── resource.py           # 资源管理工具
│   └── toJson.py             # JSON转换工具
├── templates/                 # HTML模板文件
│   ├── index.html            # 首页
│   ├── login.html            # 登录页
│   ├── register.html         # 注册页
│   ├── recommed.html         # 课程推荐页
│   ├── course_selection.html # 选课中心页
│   ├── train_plan.html       # 课程进度页
│   ├── personal_information.html  # 个人中心
│   ├── news_center.html      # 课程公告
│   ├── course_discussion.html    # 课程讨论
│   ├── inbox.html            # 消息中心
│   ├── manager.html          # 管理员主页
│   ├── managerAdd.html       # 添加学生
│   ├── managerEdit.html      # 编辑学生信息
│   ├── managerDelete.html    # 删除学生
│   ├── managerBroadcast.html # 发布公告
│   ├── 404.html              # 404错误页
│   ├── 500.html              # 500错误页
│   └── ...                   # 其他模板文件
├── static/                    # 静态资源
│   ├── css/                  # 样式文件
│   │   ├── style1.css        # 主要样式
│   │   └── ...               # 其他样式文件
│   ├── js/                   # JavaScript文件
│   │   ├── jquery-2.2.4.min.js  # jQuery库
│   │   ├── echarts.min.js    # ECharts图表库
│   │   ├── recommedBar.js    # 推荐图表展示
│   │   └── ...               # 其他JS文件
│   └── images/               # 图片资源
│       ├── logo.jpg          # 系统Logo
│       ├── logo.ico          # 网站图标
│       └── ...               # 其他图片
├── sql/                       # 数据库脚本
│   ├── schema.sql            # 数据库表结构
│   ├── insert_student.sql    # 学生基础数据
│   ├── insert_education_plan.sql  # 培养计划数据
│   ├── insert_choose.sql     # 选课记录数据
│   ├── insert_edu_stu_plan.sql   # 学生培养计划数据
│   ├── insert_loginformation.sql # 登录日志数据
│   └── create_difficulty_rating_table.sql  # 课程难度评分表
├── exampleImage/              # 示例截图
│   ├── index.png             # 首页截图
│   ├── recommend.png         # 推荐页截图
│   └── ...                   # 其他截图
├── docs/                      # 文档目录
│   ├── 课程推荐机制说明.md    # 推荐系统详细说明
│   ├── 选课中心流程图.md      # 选课中心功能流程图
│   ├── 选课流程图_mermaid.txt  # 选课流程图Mermaid代码
│   └── 学生培养计划管理系统说明书.pdf # 系统说明书
├── .gitignore                # Git忽略文件
├── .gitattributes           # Git属性配置
└── README.md                 # 项目说明文档
```

## 🎯 主要功能模块详解

### 0. 🏠 首页优化

**访问路径**：`/index`

**功能特点**：
- **优化布局**：减少大幅横幅图片占比，增强信息密度
- **学生当前学习状态**：
  - 显示学生姓名、学院、专业、年级
  - 显示总学分、已选课程数
  - 显示最近选课记录
- **课程进度展示**：
  - 进度总览卡片（总课程数/已完成/进行中/待完成）
  - 课程进度列表，显示每门课程的：
    - 课程名称、授课教师、上课时间
    - 当前周次/总周次
    - 进度条（百分比）
    - 最近学习内容
    - 学习状态（进行中/已完成）
    - "即将截止"提醒标识
- **数据同步**：课程进度数据与课程进度页面同步
- **实时更新**：使用AJAX动态加载数据，无需刷新页面

---

### 1. 📊 课程推荐系统

**访问路径**：`/recommed`

**核心特点**：
- **智能推荐算法**：基于协同过滤算法，根据学生选课历史推荐专业选修课程
- **动态更新机制**：选课/退课后，推荐结果自动更新，无需手动刷新
- **多维度展示**：课程相似度分析图表 + 学习画像相似度图表
- **相似学生推荐**：推荐志同道合的朋友，促进学习交流
- **一键刷新**：支持手动刷新获取最新推荐结果

**推荐策略**：
- **数据充足（≥3门选课）**：使用协同过滤推荐，个性化程度高
- **数据不足（<3门选课）**：使用冷启动推荐，基于专业的热门课程
- **算法失败时**：智能回退到热门课程推荐，确保总有推荐结果

**新增功能**：
- **课程难度评分**：可对推荐课程进行多维度难度评分
- **课程讨论跳转**：直接跳转到课程相关讨论区
- **前往选课**：一键跳转到选课中心进行选课

---

### 2. 📚 选课中心

**访问路径**：`/course_selection`

**功能特点**：
- **智能搜索**：
  - 支持按课程号或课程名称进行模糊搜索
  - 搜索到单门课程时，自动在搜索框下方显示课程详情卡片
  - 支持实时搜索，输入即搜索
- **多条件筛选**：
  - 学院筛选（默认选中"智能与计算学部"）
  - 课程类型筛选（必修/选修/公选）
  - 学分范围筛选（最小-最大学分）
  - 上课时间筛选
- **课程列表展示**：
  - 表格形式展示，信息清晰
  - 显示课程编号、名称、分类、学分、任课教师
  - 显示上课时间、课程容量（已选/总数）、开课学院
  - 课程状态标识（可选/已满/已选）
- **选课状态管理**：
  - 清晰显示可选/已满/已选状态
  - 按钮状态动态变化，防止重复操作
  - 已选课程显示"已选"标签，按钮禁用
- **选课统计信息**：
  - 实时显示已选课程数量
  - 显示已修总学分
  - 自动检测时间冲突并提示警告
  - 统计信息自动更新
- **选课/退课操作**：
  - 支持一键选课/退课
  - 操作前确认提示
  - 操作结果实时反馈（成功/失败消息）
  - 选课成功后自动刷新列表和统计
- **数据同步**：
  - 选课/退课后，推荐系统自动更新
  - 课程进度信息同步更新
  - 个人中心统计数据实时更新

**选课流程**：
1. 使用搜索框输入课程号或名称，或使用筛选条件查找课程
2. 如果搜索到单门课程，自动显示课程详情卡片
3. 查看课程详细信息（学分、容量、时间、教师等）
4. 点击"选课"按钮，确认选课
5. 系统验证：课程是否存在、是否已选、容量是否已满
6. 选课成功后，列表和统计信息自动更新
7. 推荐系统自动更新推荐结果

**技术实现**：
- 前端使用 jQuery 进行 AJAX 请求
- 后端提供 RESTful API 接口
- 支持实时搜索和筛选
- 完善的错误处理和用户反馈
- 时间冲突智能检测算法

---

### 3. ⭐ 课程难度评分系统

**访问路径**：课程推荐页面的"难度评分"按钮

**评分维度**：
- **整体难度**：课程的综合难度评价
- **理论难度**：理论知识的理解和掌握难度
- **实践难度**：实验、项目等实践环节的难度
- **作业难度**：课后作业和考核的难度

**功能特点**：
- **星级评分**：1-5星评分系统，直观易用
- **评价说明**：支持文字评价，提供详细建议
- **统计展示**：显示课程的平均评分和评价人数
- **防重复评分**：每个学生每门课程只能评分一次，可修改

**使用价值**：
- 帮助学生了解课程真实难度
- 为选课决策提供参考依据
- 促进课程质量改进

---

### 4. 🤖 AI 学习助手

**访问路径**：首页或导航栏的AI助手入口

**功能特点**：
- **智能问答**：基于DeepSeek API的自然语言处理
- **学习咨询**：回答学习相关问题，提供学习建议
- **实时对话**：支持多轮对话，上下文理解
- **专业知识**：涵盖计算机科学、数学、工程等专业领域

**配置要求**：
- 需要设置 `DEEPSEEK_API_KEY` 环境变量
- 需要网络连接访问DeepSeek API
- 可选功能，不影响其他模块使用

---

### 5. 📈 课程进度管理

**访问路径**：`/train_plan`

**功能特点**：
- **进度总览区**：卡片形式展示学习概况
  - 课程总数、已完成课程数、进行中课程数、待完成课程数
  - 配合进度条或图表进行可视化展示
- **课程进度详情**：卡片/表格形式展示每门课程
  - 课程名称、授课教师、上课时间
  - 当前周次/总周次（自动计算）
  - 学习进度条（百分比显示）
  - 最近学习内容或当前章节
  - 学习状态（进行中/已完成）
- **操作入口**：每门课程提供"进入课程"、"查看详情"按钮
- **辅助提示**：对即将截止的课程任务或进度落后的课程进行醒目标识
- **进度同步**：课程进度信息同步到首页展示
- **周次计算**：根据课程开始/结束日期和当前日期自动计算周次
- **进度计算**：根据周次自动计算课程完成百分比

**进度分类**：
- 思想政治理论、外语、文化素质教育
- 体育、军事、健康教育
- 数学、物理、计算机
- 学科基础、专业选修

---

### 6. 💬 课程论坛系统

**访问路径**：
- 课程讨论列表：`/news_center` 或 `/news_center/discussion`
- 发布话题：`/course_discussion`
- 话题详情：`/detail/<news_id>`

**功能特点**：
- **左右布局设计**：左侧导航栏（课程讨论/发布话题/我的话题/热门讨论），右侧内容区
- **话题发布**：支持发布新话题，标题和内容验证，字符计数，发布成功后自动跳转
- **话题列表**：卡片式展示，显示标题、发帖人、发布时间、回复数、浏览数
- **状态标签**：最新、置顶、教师回复、热门等标签标识
- **排序功能**：支持按最新发布、回复最多、我的参与进行排序
- **筛选功能**：支持查看全部、我的话题、热门讨论
- **分页显示**：支持分页浏览，每页10条
- **话题回复**：支持在话题详情页回复，显示回复列表
- **AJAX交互**：所有操作采用AJAX，无需刷新页面

**技术实现**：
- 前端使用jQuery进行AJAX请求
- 后端提供RESTful API接口
- 支持JSON格式数据交互
- 完善的错误处理和用户反馈

---

### 7. 👤 个人中心

**访问路径**：`/personal_information`

**页面布局**：
- **左右布局设计**：左侧导航栏 + 右侧内容区
- **左侧导航栏**：
  - 头像区域：显示学生头像、姓名、学号
  - 菜单列表：个人信息（高亮）、账号安全、课程记录、消息中心、系统设置
- **右侧内容区**：
  - 个人信息卡片：头像、姓名、学号、学院、专业、年级，"编辑资料"按钮
  - 学习状态概览：本学期课程数、已修学分、未完成课程数、课程进度（已完成/总数）
  - 系统功能提示：选课未完成、课程评价待提交、个人信息可完善等提醒

**功能模块**：
- **基本信息编辑**：支持编辑姓名、性别、学院、专业等信息
- **头像管理**：支持头像上传和更换，支持JPG/PNG/GIF格式
- **密码修改**：安全的密码修改功能
- **学习统计**：实时显示个人学习数据统计和分析
- **系统提醒**：显示教务相关提醒和待办事项
- **课程记录**：查看历史选课记录和成绩

**视觉风格**：
- 卡片式布局，圆角设计，轻阴影
- 主色调使用学校官方配色（深蓝/校徽红）
- 信息层级清晰，专业可信

---

### 8. 📬 消息中心

**访问路径**：`/inbox`

**功能特点**：
- **系统公告**：查看管理员发布的系统公告和通知
- **筛选功能**：支持按类型筛选（考试安排/选课公告/系统公告/教务通知）
- **排序功能**：支持按时间升序/降序排序
- **搜索功能**：支持按关键词搜索公告
- **公告详情**：点击查看公告详细内容
- **已读管理**：标记消息已读状态
- **个性化推送**：根据学生学院、专业推送相关公告

---

### 9. 🔧 管理员功能

**访问路径**：`/manager`（管理员登录后）

**管理功能**：
- **学生管理**：增加、删除、编辑学生信息
- **公告管理**：发布系统公告和课程通知
- **数据统计**：查看系统使用统计数据
- **系统维护**：数据库维护和系统配置

## 🔌 API 接口文档

### 学生相关接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/api/get_student_status` | GET | 获取学生当前学习状态 |
| `/api/get_learning_statistics` | GET | 获取学生学习统计数据（课程数/学分/进度） |
| `/api/update_personal_info` | POST | 更新学生个人信息 |
| `/api/upload_avatar` | POST | 上传学生头像 |
| `/api/change_password` | POST | 修改密码 |
| `/api/get_course_records` | GET | 获取学生课程记录 |

### 课程相关接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/api/get_filtered_courses` | GET | 获取筛选后的课程列表（支持课程号/名称搜索和多条件筛选） |
| `/api/get_selection_statistics` | GET | 获取选课统计信息（已选课程数/已修学分/时间冲突检测） |
| `/api/select_course` | POST | 选课操作（验证容量、重复选课等） |
| `/api/drop_course` | POST | 退课操作（验证选课状态等） |
| `/api/get_course_progress_detail` | GET | 获取课程进度详情 |
| `/api/get_course_categories` | GET | 获取课程分类 |
| `/api/get_courses_by_category` | GET | 按分类获取课程 |
| `/api/submit_course_score` | POST | 提交课程难度评分 |

### 论坛相关接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/api/get_discussion_topics` | GET | 获取讨论话题列表（支持排序和筛选） |
| `/api/get_topic_replies` | GET | 获取话题回复列表 |
| `/course_discussion` | POST | 发布新话题 |
| `/detail/<news_id>` | POST | 回复话题 |

### 消息相关接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/api/announcements` | GET | 获取系统公告列表（支持筛选和排序） |
| `/api/get_system_notices` | GET | 获取系统提醒信息 |

### 推荐相关接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/getRecommedData` | GET | 获取课程推荐数据 |

### AI助手接口

| 接口路径 | 方法 | 说明 |
|---------|------|------|
| `/api/deepseek_chat` | POST | AI学习助手对话接口 |

> 📝 **注意**：所有需要登录的接口，如果用户未登录，将返回 401 状态码。

## 🔧 常见问题与解决方案

### 🗄️ 数据库相关问题

**Q: ERROR 1366 / 1406 字符集错误？**

A: 这是最常见的问题，99%是字符集未正确设置。解决方法：
```sql
# 重新连接MySQL并设置字符集
mysql -u root -p
SET NAMES utf8mb4;
SET CHARACTER SET utf8mb4;

# 检查数据库字符集
SHOW CREATE DATABASE studenttrainplan;

# 如果字符集不对，重新创建数据库
DROP DATABASE IF EXISTS studenttrainplan;
CREATE DATABASE studenttrainplan CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

**Q: 无法连接数据库？**

A: 检查以下几点：
1. **配置文件**：确认 `config.py` 中的密码与本地MySQL一致
2. **MySQL服务**：确保MySQL服务已启动
3. **用户权限**：检查MySQL用户是否有足够权限
4. **端口占用**：确认3306端口未被占用

**Q: 导入SQL文件失败？**

A: 可能的解决方案：
```sql
# 方法1：逐个导入文件
SOURCE sql/schema.sql;
# 检查是否有错误，然后继续下一个

# 方法2：使用命令行导入
mysql -u root -p studenttrainplan < sql/schema.sql
```

---

### 🤖 AI助手相关问题

**Q: AI助手无响应或报错？**

A: 检查步骤：
1. **API密钥**：确认已正确设置 `DEEPSEEK_API_KEY` 环境变量
2. **网络连接**：确保服务器能访问外网
3. **API额度**：检查DeepSeek账户是否有可用额度
4. **重启应用**：修改环境变量后需要重启Flask应用

**Q: 如何获取DeepSeek API密钥？**

A: 
1. 访问 [DeepSeek官网](https://platform.deepseek.com/)
2. 注册账号并完成认证
3. 在API管理页面创建新的API密钥
4. 首次使用可能需要充值或申请免费额度

---

### 📊 推荐系统相关问题

**Q: 推荐结果为空或显示"暂无推荐"？**

A: 可能原因和解决方案：
1. **学生已选完所有课程**：正常情况，无需处理
2. **数据库选课数据不足**：添加更多测试选课数据
3. **算法计算失败**：查看后端控制台的调试信息
4. **数据库连接问题**：检查数据库连接状态

**Q: 相似学生推荐都显示相同分数？**

A: 这通常表示：
1. **选课数据相似度高**：学生选课模式比较相似
2. **算法优化**：系统已优化，会综合考虑多个因素
3. **数据量不足**：增加更多样化的选课数据

**Q: 推荐结果不更新？**

A: 解决方法：
1. **手动刷新**：点击页面上的"刷新推荐"按钮
2. **清除缓存**：清除浏览器缓存后重新访问
3. **检查选课**：确认选课操作确实成功

---

### 🌐 前端相关问题

**Q: 页面显示异常或JavaScript错误？**

A: 调试步骤：
1. **开发者工具**：按F12打开，查看Console标签页的错误信息
2. **jQuery兼容性**：确认使用的是兼容版本的jQuery
3. **浏览器兼容性**：建议使用Chrome、Firefox等现代浏览器
4. **缓存问题**：强制刷新页面（Ctrl+F5）

**Q: 发布话题后没有成功提示？**

A: 已修复的问题，解决方案：
1. **使用主页面**：访问 `/course_discussion`（已修复）
2. **备用页面**：如有问题可访问 `/course_discussion_simple`
3. **检查控制台**：查看是否有JavaScript错误

---

### 🚀 性能优化问题

**Q: 页面加载缓慢？**

A: 优化建议：
1. **数据库优化**：为常用查询字段添加索引
2. **静态资源**：使用CDN加速静态资源加载
3. **缓存策略**：启用浏览器缓存和服务器缓存
4. **数据分页**：对大量数据进行分页显示

**Q: 推荐计算耗时过长？**

A: 优化方案：
1. **数据量控制**：限制参与计算的数据量
2. **算法优化**：使用更高效的相似度计算方法
3. **缓存结果**：缓存推荐结果，定期更新
4. **异步处理**：将推荐计算改为异步处理

---

### 🔐 安全相关问题

**Q: 如何修改默认密码？**

A: 安全建议：
1. **管理员密码**：登录后在个人中心修改
2. **学生密码**：各学生登录后自行修改
3. **数据库密码**：修改 `config.py` 中的数据库密码
4. **定期更新**：建议定期更新所有密码

**Q: 如何防止SQL注入？**

A: 系统已采取的措施：
1. **参数化查询**：使用PyMySQL的参数化查询
2. **输入验证**：对用户输入进行验证和过滤
3. **权限控制**：数据库用户权限最小化
4. **定期更新**：保持依赖库的最新版本

## 📚 相关文档

- [课程推荐机制说明.md](./课程推荐机制说明.md)：详细的推荐系统算法和机制说明
- [选课中心流程图.md](./选课中心流程图.md)：选课中心功能实现流程图和详细说明
- [选课流程图_mermaid.txt](./选课流程图_mermaid.txt)：选课流程的Mermaid代码，可直接用于文档生成

## 🚢 部署指南

### 开发环境部署

**本地开发**：
```bash
# 克隆项目
git clone https://github.com/gsolvit/studentTrainPlan.git
cd studentTrainPlan

# 安装依赖
pip install -r requirements.txt  # 如果有requirements.txt
# 或者手动安装
pip install Flask numpy pymysql openai

# 配置数据库
# 按照前面的步骤初始化数据库

# 启动应用
python main.py
```

### 生产环境部署

**使用Gunicorn + Nginx（推荐）**：

1. **安装Gunicorn**：
```bash
pip install gunicorn
```

2. **创建Gunicorn配置文件** `gunicorn.conf.py`：
```python
bind = "127.0.0.1:5000"
workers = 4
worker_class = "sync"
timeout = 30
keepalive = 2
max_requests = 1000
max_requests_jitter = 100
```

3. **启动Gunicorn**：
```bash
gunicorn -c gunicorn.conf.py main:app
```

4. **Nginx配置示例**：
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    location /static {
        alias /path/to/studentTrainPlan/static;
        expires 30d;
    }
}
```

### Docker部署

**创建Dockerfile**：
```dockerfile
FROM python:3.8-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["gunicorn", "-b", "0.0.0.0:5000", "main:app"]
```

**使用Docker Compose**：
```yaml
version: '3.8'
services:
  web:
    build: .
    ports:
      - "5000:5000"
    environment:
      - DEEPSEEK_API_KEY=your_api_key
    depends_on:
      - db
  
  db:
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: your_password
      MYSQL_DATABASE: studenttrainplan
    volumes:
      - mysql_data:/var/lib/mysql
      - ./sql:/docker-entrypoint-initdb.d

volumes:
  mysql_data:
```

### 云平台部署

**Heroku部署**：
1. 创建 `Procfile`：
```
web: gunicorn main:app
```

2. 创建 `requirements.txt`：
```
Flask>=2.0.0
numpy>=1.19.0
pymysql>=1.0.0
openai>=1.0.0
gunicorn>=20.0.0
```

3. 部署命令：
```bash
heroku create your-app-name
git push heroku main
```

**阿里云/腾讯云部署**：
- 使用云服务器ECS
- 配置安全组开放80/443端口
- 使用云数据库RDS（推荐）
- 配置域名和SSL证书

### 部署检查清单

**部署前检查**：
- [ ] 数据库连接配置正确
- [ ] 环境变量设置完整
- [ ] 静态文件路径正确
- [ ] 安全配置（防火墙、SSL等）

**部署后验证**：
- [ ] 网站可正常访问
- [ ] 登录功能正常
- [ ] 数据库操作正常
- [ ] AI助手功能正常（如果启用）
- [ ] 推荐系统正常工作

### 性能优化建议

**数据库优化**：
```sql
-- 为常用查询添加索引
CREATE INDEX idx_stu_no ON CHOOSE(STU_NO);
CREATE INDEX idx_co_no ON CHOOSE(CO_NO);
CREATE INDEX idx_course_name ON COURSE_DIFFICULTY_RATING(COURSE_NAME);
```

**应用优化**：
- 启用Flask缓存
- 使用Redis缓存推荐结果
- 静态资源CDN加速
- 数据库连接池

**监控和日志**：
- 配置应用日志
- 监控系统资源使用
- 设置错误报警
- 定期备份数据库

## 📸 界面预览

![主页](./exampleImage/index.png)
![课程进度](./exampleImage/plan.png)
![推荐](./exampleImage/recommend.png)
![课程论坛](./exampleImage/discuss.png)
![AI助手](./exampleImage/aiAssistant.png)

## 📝 更新日志

### v3.6 (2024-12-26) - 最新版本
- 🎯 **选课中心功能增强**
  - 新增单课程搜索自动显示详情功能（搜索到1门课程时，自动在搜索框下方显示详情卡片）
  - 优化学院筛选默认值（默认选中"智能与计算学部"）
  - 新增选课统计API接口（`/api/get_selection_statistics`）
  - 完善时间冲突检测功能，自动提示冲突警告
  - 优化搜索体验，支持实时搜索和筛选
- 🔧 **系统稳定性提升**
  - 修复选课统计API 404错误
  - 优化学院列表获取逻辑
  - 完善错误处理和用户反馈
  - 改进前端兼容性问题（jQuery版本兼容）
- 📚 **文档完善**
  - 新增选课中心流程图文档（`选课中心流程图.md`）
  - 新增选课流程图Mermaid代码（`选课流程图_mermaid.txt`）
  - 更新README文档，补充最新功能说明

### v3.5 (2024-12-25)
- ✨ **首页优化升级**
  - 减少横幅图片占比，增强信息密度
  - 新增"学生当前学习状态"展示区
  - 新增"课程进度"概览，同步课程进度数据
  - 优化页面布局，提升功能实用性
- 🎨 **个人中心全面重构**
  - 采用左右布局设计，导航栏 + 内容区
  - 新增学习状态概览（课程数/学分/进度）
  - 新增系统功能提示区（选课/评价/资料提醒）
  - 优化个人信息卡片，支持编辑资料
  - 改进头像上传功能，支持多种图片格式
- 💬 **课程论坛功能增强**
  - 优化左右布局，导航栏 + 话题列表
  - 完善话题发布功能，支持AJAX提交
  - 新增话题排序（最新/回复最多/我的参与）
  - 新增话题筛选（全部/我的话题/热门）
  - 新增状态标签（最新/教师回复/热门）
  - 支持话题回复功能，显示回复列表
  - 完善分页功能，优化用户体验
- 📚 **选课中心功能完善**
  - 新增课程号/名称搜索功能
  - 新增多条件筛选（学院/类型/学分/时间）
  - 优化课程列表展示，显示详细状态
  - 新增选课统计（已选数/学分/冲突检测）
  - 改进选课/退课交互，实时反馈
- 📈 **课程进度模块优化**
  - 新增进度总览区（总数/已完成/进行中/待完成）
  - 优化课程详情列表，显示周次和进度条
  - 新增周次自动计算功能
  - 新增进度百分比计算
  - 支持进度信息同步到首页
  - 新增"即将截止"和"进度落后"提醒
- 🔧 **系统稳定性提升**
  - 修复多个API接口错误处理
  - 优化数据库查询性能
  - 完善前端错误提示机制
  - 改进AJAX请求处理逻辑

### v3.0 (2024-12-20)
- ✨ **新增课程难度评分系统**
  - 多维度评分（整体/理论/实践/作业难度）
  - 星级评分界面，支持评价说明
  - 评分统计展示，防重复评分
- 🎯 **优化课程推荐功能**
  - 推荐页面按钮功能升级
  - 新增难度评分、课程讨论跳转
  - 改进推荐结果展示和交互
- 🔧 **系统稳定性提升**
  - 修复jQuery兼容性问题
  - 优化前端JavaScript代码
  - 完善错误处理机制
- 📚 **文档完善**
  - 更新README文档，增加详细说明
  - 新增功能修复总结文档
  - 完善部署和使用指南

### v2.5 (2024-12-20)
- 🐛 **修复发布成功消息问题**
  - 解决ES6模板字符串兼容性问题
  - 升级jQuery到1.12.4版本
  - 添加错误处理和降级方案
- 🎨 **界面优化**
  - 改进成功消息显示效果
  - 优化论坛页面加载状态
  - 增强用户操作反馈

### v2.0 (2024-12-15)
- ✨ **新增选课中心功能**
  - 支持专业选修课程选课/退课
  - 实时显示课程容量和选课统计
  - 选课操作与推荐系统联动
- 🎯 **升级推荐系统**
  - 从SVD算法升级为协同过滤算法
  - 实现动态推荐，支持实时更新
  - 新增相似学生推荐功能
- 🔄 **推荐结果优化**
  - 支持多策略融合（协同过滤+冷启动+热门推荐）
  - 专业匹配优先，推荐精度提升
  - 智能回退机制，确保总有推荐结果
- 📊 **数据可视化增强**
  - ECharts图表展示推荐结果
  - 课程相似度和学生相似度双重展示
  - 交互式图表，支持数据筛选
- 🐛 **问题修复**
  - 修复推荐系统相关bug
  - 优化数据库查询性能
  - 完善异常处理机制

### v1.5 (2024-12-01)
- 🤖 **新增AI学习助手**
  - 集成DeepSeek API
  - 支持学习问题智能问答
  - 实时对话交互功能
- 💬 **论坛功能完善**
  - 课程讨论区优化
  - 支持话题发布和回复
  - 改进消息提示机制
- 👤 **个人中心增强**
  - 新增头像上传功能
  - 支持个人信息编辑
  - 密码修改功能

### v1.0 (2024-11-15) - 初始版本
- 📊 **基础功能实现**
  - 培养计划可视化树形图
  - 基于SVD的课程推荐
  - 学生信息管理系统
- 💬 **论坛系统**
  - 课程公告发布
  - 基础讨论功能
- 🔧 **管理员功能**
  - 学生信息增删改
  - 系统数据维护
- 📈 **进度管理**
  - 课程完成状态跟踪
  - 学分统计功能

---

## 🔮 未来规划

### 短期计划 (v3.7)
- [ ] **移动端适配**：优化移动设备访问体验，响应式设计优化
- [ ] **课程评价系统**：扩展评分功能，支持课程质量评价和文字评价
- [ ] **学习路径推荐**：基于课程依赖关系的学习路径规划
- [ ] **数据导出功能**：支持学习数据和统计报告导出（PDF/Excel）
- [ ] **消息推送**：实时消息推送，课程提醒功能
- [ ] **选课冲突优化**：更智能的时间冲突检测和提示（精确到时间段）
- [ ] **选课历史记录**：查看历史选课记录和退课记录
- [ ] **课程收藏功能**：收藏感兴趣的课程，方便后续选课

### 中期计划 (v4.0)
- [ ] **微服务架构**：拆分为多个微服务，提高系统可扩展性
- [ ] **实时通知系统**：WebSocket实时消息推送
- [ ] **高级分析功能**：学习行为分析和预测
- [ ] **多校区支持**：支持多校区、多专业的复杂场景

### 长期愿景
- [ ] **智能学习助手升级**：更强大的AI功能，个性化学习建议
- [ ] **社交学习网络**：构建学生学习社交网络
- [ ] **开放API平台**：提供第三方集成接口
- [ ] **大数据分析平台**：教学质量分析和改进建议

## 📄 许可证

本项目采用 MIT 许可证。

## 👥 贡献

欢迎提交 Issue 和 Pull Request！

## 📮 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 参考 [CSDN 博客](https://blog.csdn.net/qq_40423339)

---

**⭐ 如果这个项目对你有帮助，欢迎 Star！**
