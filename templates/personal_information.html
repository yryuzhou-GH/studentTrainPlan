<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<link href="../static/css/style1.css" rel="stylesheet" type="text/css" />
        <link rel="icon" href="../static/images/logo.ico" type="image/x-icon"/>
	<script src="{{ url_for('static', filename='js/jquery1.42.min.js') }}" type="text/javascript"></script>
	<script src="{{ url_for('static', filename='js/jquery.js') }}"></script>
		<title>ä¸ªäººä¸­å¿ƒ</title>
	</head>

	<body>
		<div class="wapper_box">
			<div class="header_box"></div>
			<div class="header_box1">
				<div class="header_box2">
				<a class="logo_box" href="{{ url_for('index') }}"><img src="{{ url_for('static', filename='images/logo1.jpg') }}"/></a>
					<ul class="nav_box">
						<li class="nav_1"><a class="nav_but" href="{{ url_for('personal_information') }}">ä¸ªäººä¸­å¿ƒ</a></li>
            			<li class="nav_1"><a class="nav_but" href="{{ url_for('inbox') }}">æ¶ˆæ¯ä¸­å¿ƒ</a></li>
						<li class="nav_1"><a class="nav_but" href="{{ url_for('news_center') }}">è¯¾ç¨‹è®ºå›</a>
               				<div class="nav_slide">
                				<div class="nav_slide1">
								<a href="{{ url_for('news_center') }}">è¯¾ç¨‹å…¬å‘Š<span><img src="../static/images/siade_bg1.png"/></span></a>
								<a href="{{ url_for('course_discussion') }}">è¯¾ç¨‹è®¨è®º<span><img src="../static/images/siade_bg1.png"/></span></a>
                 				</div>
               				</div>  
             			</li>
                        <li class="nav_1"><a class="nav_but" href="{{ url_for('recommed') }}">è¯¾ç¨‹æ¨è</a></li>
                        <li class="nav_1"><a class="nav_but" href="{{ url_for('course_selection') }}">é€‰è¯¾ä¸­å¿ƒ</a></li>
             			<li class="nav_1"><a class="nav_but" href="{{ url_for('train_plan') }}">è¯¾ç¨‹è¿›åº¦</a></li>
             			<li class="nav_1"><a class="nav_but" href="{{ url_for('index') }}">é¦–é¡µ</a></li>
					</ul>
				</div>
				<script>
					$(".nav_1").mouseenter(function() {
						$(this).find(".nav_slide").slideDown()
					});
					$(".nav_1").mouseleave(function() {
						$(".nav_slide").slideUp()
					});
				</script>
			</div>

		<!-- ä¸ªäººä¸­å¿ƒä¸»ä½“å†…å®¹ -->
		<div class="personal_center_container">
			<!-- å·¦ä¾§å¯¼èˆªæ  -->
			<div class="personal_sidebar">
				<!-- å¤´åƒåŒºåŸŸ -->
				<div class="avatar_section">
					<div class="avatar_wrapper">
						<img id="user-avatar" src="{{ url_for('static', filename='images/personal.jpg') }}" alt="å¤´åƒ" />
						<div class="avatar_edit_icon">ğŸ“·</div>
				</div>
					<div id="sidebar-user-name" class="sidebar_user_name">{{ result[0][0] if result else 'åŠ è½½ä¸­...' }}</div>
					<div id="sidebar-user-id" class="sidebar_user_id">å­¦å·ï¼š{{ result[0][2] if result else 'åŠ è½½ä¸­...' }}</div>
			</div>
				
				<!-- èœå•åˆ—è¡¨ -->
				<ul class="sidebar_menu">
					<li class="menu_item {% if section == 'personal_info' or not section %}active{% endif %}">
						<a href="{{ url_for('personal_information', section='personal_info') }}">
							<span class="menu_icon">ğŸ‘¤</span>
							<span class="menu_text">ä¸ªäººä¿¡æ¯</span>
						</a>
					</li>
					<li class="menu_item {% if section == 'account_security' %}active{% endif %}">
						<a href="{{ url_for('personal_information', section='account_security') }}">
							<span class="menu_icon">ğŸ”’</span>
							<span class="menu_text">è´¦å·å®‰å…¨</span>
						</a>
					</li>
					<li class="menu_item {% if section == 'course_records' %}active{% endif %}">
						<a href="{{ url_for('personal_information', section='course_records') }}">
							<span class="menu_icon">ğŸ“‹</span>
							<span class="menu_text">è¯¾ç¨‹è®°å½•</span>
						</a>
					</li>
					<li class="menu_item">
						<a href="{{ url_for('inbox') }}">
							<span class="menu_icon">ğŸ’¬</span>
							<span class="menu_text">æ¶ˆæ¯ä¸­å¿ƒ</span>
						</a>
					</li>
					<li class="menu_item {% if section == 'settings' %}active{% endif %}">
						<a href="{{ url_for('personal_information', section='settings') }}">
							<span class="menu_icon">âš™ï¸</span>
							<span class="menu_text">ç³»ç»Ÿè®¾ç½®</span>
						</a>
							</li>
						</ul>
					</div>

			<!-- å³ä¾§å†…å®¹åŒº -->
			<div class="personal_content">
				{% if section == 'personal_info' or not section %}
				<!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
				<div class="info_card">
					<div class="card_header">
						<h2 class="card_title">ä¸ªäººä¿¡æ¯</h2>
						<button class="edit_btn" id="edit-info-btn">ç¼–è¾‘èµ„æ–™</button>
							</div>
					<div class="card_body">
						<div class="info_avatar_section">
							<img id="info-avatar" src="{{ url_for('static', filename='images/personal.jpg') }}" alt="å¤´åƒ" />
							<button class="change_avatar_btn">æ›´æ¢å¤´åƒ</button>
						</div>
						<div class="info_details">
							<div class="info_row">
								<div class="info_item">
									<span class="info_label">å§“å</span>
									<span id="info-name" class="info_value">{{ result[0][0] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
								<div class="info_item">
									<span class="info_label">å­¦å·</span>
									<span id="info-stu-no" class="info_value">{{ result[0][2] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
							</div>
							<div class="info_row">
								<div class="info_item">
									<span class="info_label">å­¦é™¢</span>
									<span id="info-college" class="info_value">{{ result[0][3] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
								<div class="info_item">
									<span class="info_label">ä¸“ä¸š</span>
									<span id="info-major" class="info_value">{{ result[0][4] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
							</div>
							<div class="info_row">
								<div class="info_item">
									<span class="info_label">å¹´çº§</span>
									<span id="info-grade" class="info_value">{{ result[0][5] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
								<div class="info_item">
									<span class="info_label">æ€§åˆ«</span>
									<span id="info-sex" class="info_value">{{ result[0][1] if result else 'åŠ è½½ä¸­...' }}</span>
								</div>
							</div>
						</div>
					</div>
				</div>

				<!-- å­¦ä¹ çŠ¶æ€æ¦‚è§ˆåŒº -->
				<div class="learning_status_card">
					<div class="card_header">
						<h2 class="card_title">å­¦ä¹ çŠ¶æ€æ¦‚è§ˆ</h2>
					</div>
					<div class="card_body">
						<div id="learning-statistics" class="statistics_grid">
							<div class="loading">åŠ è½½ä¸­...</div>
						</div>
							</div>
						</div>
						
				<!-- ç³»ç»ŸåŠŸèƒ½æç¤ºåŒº -->
				<div class="system_notices_card">
					<div class="card_header">
						<h2 class="card_title">ç³»ç»Ÿæé†’</h2>
						</div>
					<div class="card_body">
						<div id="system-notices" class="notices_list">
							<div class="loading">åŠ è½½ä¸­...</div>
					</div>
				</div>
				</div>
				{% elif section == 'account_security' %}
				<!-- è´¦å·å®‰å…¨é¡µé¢ -->
				<div class="info_card">
					<div class="card_header">
						<h2 class="card_title">è´¦å·å®‰å…¨</h2>
					</div>
					<div class="card_body">
						<div class="security_section">
							<h3 class="section_subtitle">ä¿®æ”¹å¯†ç </h3>
							<form id="change-password-form" class="security_form">
								<div class="form_group">
									<label for="old-password">åŸå¯†ç </label>
									<input type="password" id="old-password" name="old_password" required />
								</div>
								<div class="form_group">
									<label for="new-password">æ–°å¯†ç </label>
									<input type="password" id="new-password" name="new_password" required minlength="6" />
									<small class="form_hint">å¯†ç é•¿åº¦è‡³å°‘6ä½</small>
								</div>
								<div class="form_group">
									<label for="confirm-password">ç¡®è®¤æ–°å¯†ç </label>
									<input type="password" id="confirm-password" name="confirm_password" required minlength="6" />
								</div>
								<div class="form_actions">
									<button type="submit" class="btn_submit">ä¿®æ”¹å¯†ç </button>
								</div>
							</form>
						</div>
						<div class="security_section">
							<h3 class="section_subtitle">å®‰å…¨è®¾ç½®</h3>
							<div class="security_item">
								<div class="security_info">
									<div class="security_label">ç™»å½•ä¿æŠ¤</div>
									<div class="security_desc">å·²å¼€å¯ï¼Œä¿æŠ¤æ‚¨çš„è´¦å·å®‰å…¨</div>
								</div>
								<label class="switch">
									<input type="checkbox" checked disabled>
									<span class="slider"></span>
								</label>
							</div>
							<div class="security_item">
								<div class="security_info">
									<div class="security_label">è´¦å·çŠ¶æ€</div>
									<div class="security_desc">è´¦å·æ­£å¸¸ï¼Œæ— å¼‚å¸¸ç™»å½•è®°å½•</div>
								</div>
								<span class="status_badge status_success">æ­£å¸¸</span>
							</div>
						</div>
					</div>
				</div>
				{% elif section == 'course_records' %}
				<!-- è¯¾ç¨‹è®°å½•é¡µé¢ -->
				<div class="info_card">
					<div class="card_header">
						<h2 class="card_title">è¯¾ç¨‹è®°å½•</h2>
					</div>
					<div class="card_body">
						<div id="course-records-content">
							<div class="loading">åŠ è½½ä¸­...</div>
						</div>
					</div>
				</div>
				{% elif section == 'settings' %}
				<!-- ç³»ç»Ÿè®¾ç½®é¡µé¢ -->
				<div class="info_card">
					<div class="card_header">
						<h2 class="card_title">ç³»ç»Ÿè®¾ç½®</h2>
					</div>
					<div class="card_body">
						<div class="settings_section">
							<h3 class="section_subtitle">é€šçŸ¥è®¾ç½®</h3>
							<div class="setting_item">
								<div class="setting_info">
									<div class="setting_label">è¯¾ç¨‹æé†’</div>
									<div class="setting_desc">æ¥æ”¶è¯¾ç¨‹ç›¸å…³é€šçŸ¥</div>
								</div>
								<label class="switch">
									<input type="checkbox" id="course-notify" checked>
									<span class="slider"></span>
								</label>
							</div>
							<div class="setting_item">
								<div class="setting_info">
									<div class="setting_label">ç³»ç»Ÿå…¬å‘Š</div>
									<div class="setting_desc">æ¥æ”¶ç³»ç»Ÿå…¬å‘Šå’Œé‡è¦é€šçŸ¥</div>
								</div>
								<label class="switch">
									<input type="checkbox" id="system-notify" checked>
									<span class="slider"></span>
								</label>
							</div>
						</div>
						<div class="settings_section">
							<h3 class="section_subtitle">æ˜¾ç¤ºè®¾ç½®</h3>
							<div class="setting_item">
								<div class="setting_info">
									<div class="setting_label">ä¸»é¢˜æ¨¡å¼</div>
									<div class="setting_desc">é€‰æ‹©ç•Œé¢æ˜¾ç¤ºæ¨¡å¼</div>
								</div>
								<select id="theme-select" class="setting_select">
									<option value="light">æµ…è‰²æ¨¡å¼</option>
									<option value="dark">æ·±è‰²æ¨¡å¼</option>
									<option value="auto">è·Ÿéšç³»ç»Ÿ</option>
								</select>
							</div>
							<div class="setting_item">
								<div class="setting_info">
									<div class="setting_label">è¯­è¨€è®¾ç½®</div>
									<div class="setting_desc">é€‰æ‹©ç•Œé¢è¯­è¨€</div>
								</div>
								<select id="language-select" class="setting_select">
									<option value="zh">ç®€ä½“ä¸­æ–‡</option>
									<option value="en">English</option>
								</select>
							</div>
						</div>
						<div class="settings_section">
							<h3 class="section_subtitle">å…¶ä»–è®¾ç½®</h3>
							<div class="setting_item">
								<div class="setting_info">
									<div class="setting_label">è‡ªåŠ¨ä¿å­˜</div>
									<div class="setting_desc">è‡ªåŠ¨ä¿å­˜æ‚¨çš„æ“ä½œè®°å½•</div>
								</div>
								<label class="switch">
									<input type="checkbox" id="auto-save" checked>
									<span class="slider"></span>
								</label>
							</div>
						</div>
						<div class="settings_actions">
							<button class="btn_submit" id="save-settings-btn">ä¿å­˜è®¾ç½®</button>
							<button class="btn_cancel" id="reset-settings-btn">æ¢å¤é»˜è®¤</button>
						</div>
					</div>
				</div>
				{% endif %}
			</div>
		</div>
	</div>

	<!-- ç¼–è¾‘ä¸ªäººä¿¡æ¯æ¨¡æ€æ¡† -->
	<div id="edit-modal" class="modal">
		<div class="modal_content">
			<div class="modal_header">
				<h3>ç¼–è¾‘ä¸ªäººä¿¡æ¯</h3>
				<span class="modal_close">&times;</span>
			</div>
			<div class="modal_body">
				<form id="edit-info-form">
					<div class="form_group">
						<label for="edit-name">å§“å</label>
						<input type="text" id="edit-name" name="name" required />
					</div>
					<div class="form_group">
						<label for="edit-sex">æ€§åˆ«</label>
						<select id="edit-sex" name="sex" required>
							<option value="ç”·">ç”·</option>
							<option value="å¥³">å¥³</option>
						</select>
					</div>
					<div class="form_group">
						<label for="edit-college">å­¦é™¢</label>
						<input type="text" id="edit-college" name="college" required />
					</div>
					<div class="form_group">
						<label for="edit-major">ä¸“ä¸š</label>
						<input type="text" id="edit-major" name="major" required />
					</div>
					<div class="form_group">
						<label>å­¦å·</label>
						<input type="text" value="{{ result[0][2] if result else '' }}" disabled />
						<small class="form_hint">å­¦å·ä¸å¯ä¿®æ”¹</small>
					</div>
				</form>
			</div>
			<div class="modal_footer">
				<button type="button" class="btn_cancel" id="cancel-edit-btn">å–æ¶ˆ</button>
				<button type="button" class="btn_submit" id="submit-edit-btn">ä¿å­˜</button>
			</div>
		</div>
	</div>

	<!-- å¤´åƒä¸Šä¼ æ¨¡æ€æ¡† -->
	<div id="avatar-modal" class="modal">
		<div class="modal_content modal_small">
			<div class="modal_header">
				<h3>æ›´æ¢å¤´åƒ</h3>
				<span class="modal_close">&times;</span>
			</div>
			<div class="modal_body">
				<div class="avatar_upload_area">
					<div id="avatar-preview" class="avatar_preview">
						<img id="preview-img" src="{{ url_for('static', filename='images/personal.jpg') }}" alt="é¢„è§ˆ" />
					</div>
					<div class="upload_actions">
						<label for="avatar-input" class="btn_upload">é€‰æ‹©å›¾ç‰‡</label>
						<input type="file" id="avatar-input" accept="image/*" style="display: none;" />
						<button type="button" class="btn_submit" id="upload-avatar-btn" disabled>ä¸Šä¼ </button>
					</div>
					<small class="upload_hint">æ”¯æŒ JPGã€PNGã€GIF æ ¼å¼ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 2MB</small>
				</div>
			</div>
		</div>
	</div>

	<script>
		$(function() {
			// åŠ è½½å­¦ä¹ ç»Ÿè®¡æ•°æ®
			function loadLearningStatistics() {
				$.ajax({
					url: "/api/get_learning_statistics",
					type: "GET",
					success: function(res) {
						if (res.success && res.data) {
							let data = res.data;
							let html = `
								<div class="stat_item">
									<div class="stat_icon">ğŸ“š</div>
									<div class="stat_content">
										<div class="stat_value">${data.current_semester_courses || 0}</div>
										<div class="stat_label">æœ¬å­¦æœŸè¯¾ç¨‹æ•°</div>
									</div>
								</div>
								<div class="stat_item">
									<div class="stat_icon">ğŸ“</div>
									<div class="stat_content">
										<div class="stat_value">${data.finished_credits || 0}</div>
										<div class="stat_label">å·²ä¿®å­¦åˆ†</div>
									</div>
								</div>
								<div class="stat_item">
									<div class="stat_icon">â³</div>
									<div class="stat_content">
										<div class="stat_value">${data.unfinished_courses || 0}</div>
										<div class="stat_label">æœªå®Œæˆè¯¾ç¨‹</div>
									</div>
								</div>
								<div class="stat_item progress_item">
									<div class="stat_icon">ğŸ“Š</div>
									<div class="stat_content">
										<div class="progress_info">
											<span class="progress_label">è¯¾ç¨‹è¿›åº¦</span>
											<span class="progress_percentage">${data.total_progress || 0}%</span>
										</div>
										<div class="progress_bar_container">
											<div class="progress_bar" style="width: ${data.total_progress || 0}%"></div>
										</div>
									</div>
								</div>
							`;
							$("#learning-statistics").html(html);
						} else {
							$("#learning-statistics").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
						}
					},
					error: function() {
						$("#learning-statistics").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
					}
				});
			}

			// åŠ è½½ç³»ç»Ÿæé†’
			function loadSystemNotices() {
				$.ajax({
					url: "/api/get_system_notices",
					type: "GET",
					success: function(res) {
						if (res.success && res.data) {
							let notices = res.data;
							let html = '';
							
							notices.forEach(function(notice) {
								html += `
									<div class="notice_item notice_${notice.type}">
										<div class="notice_icon">${notice.icon}</div>
										<div class="notice_content">
											<div class="notice_title">${notice.title}</div>
											<div class="notice_message">${notice.message}</div>
										</div>
										${notice.action ? `<a href="${notice.action_url}" class="notice_action">${notice.action}</a>` : ''}
									</div>
								`;
							});
							
							$("#system-notices").html(html);
						} else {
							$("#system-notices").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
						}
					},
					error: function() {
						$("#system-notices").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
					}
				});
			}

			// æ›´æ–°ä¾§è¾¹æ ç”¨æˆ·ä¿¡æ¯
			function updateSidebarInfo() {
				// ç›´æ¥ä»é¡µé¢æ•°æ®è·å–
				var stuNo = $("#info-stu-no").text();
				var name = $("#info-name").text();
				if (name && name !== 'åŠ è½½ä¸­...') {
					$("#sidebar-user-name").text(name);
				}
				if (stuNo && stuNo !== 'åŠ è½½ä¸­...') {
					$("#sidebar-user-id").text('å­¦å·ï¼š' + stuNo);
				}
			}

			// ç¼–è¾‘æŒ‰é’®ç‚¹å‡»äº‹ä»¶
			$("#edit-info-btn").click(function(e) {
				e.preventDefault();
				// å¡«å……å½“å‰æ•°æ®åˆ°è¡¨å•
				$("#edit-name").val($("#info-name").text().trim());
				$("#edit-sex").val($("#info-sex").text().trim());
				$("#edit-college").val($("#info-college").text().trim());
				$("#edit-major").val($("#info-major").text().trim());
				// æ˜¾ç¤ºæ¨¡æ€æ¡†
				$("#edit-modal").css("display", "block").hide().fadeIn(200);
			});

			// æ›´æ¢å¤´åƒæŒ‰é’®
			$(".change_avatar_btn, .avatar_edit_icon").click(function() {
				$("#avatar-modal").fadeIn(200);
			});

			// å…³é—­æ¨¡æ€æ¡†
			$(".modal_close, .btn_cancel").click(function() {
				$(".modal").fadeOut(200);
				// é‡ç½®å¤´åƒé¢„è§ˆ
				$("#preview-img").attr("src", $("#info-avatar").attr("src"));
				$("#avatar-input").val("");
				$("#upload-avatar-btn").prop("disabled", true);
			});

			// ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
			$(".modal").click(function(e) {
				if ($(e.target).hasClass("modal")) {
					$(this).fadeOut(200);
				}
			});

			// æäº¤ç¼–è¾‘è¡¨å•
			$("#submit-edit-btn").click(function(e) {
				e.preventDefault();
				
				var formData = {
					name: $("#edit-name").val().trim(),
					sex: $("#edit-sex").val(),
					college: $("#edit-college").val().trim(),
					major: $("#edit-major").val().trim()
				};

				// è¡¨å•éªŒè¯
				var errors = [];
				if (!formData.name) errors.push("å§“åä¸èƒ½ä¸ºç©º");
				if (!formData.college) errors.push("å­¦é™¢ä¸èƒ½ä¸ºç©º");
				if (!formData.major) errors.push("ä¸“ä¸šä¸èƒ½ä¸ºç©º");
				
				if (errors.length > 0) {
					showNotification(errors.join("ï¼Œ"), "error");
					return;
				}

				// æ£€æŸ¥æ˜¯å¦æœ‰å˜åŒ–
				var currentName = $("#info-name").text().trim();
				var currentSex = $("#info-sex").text().trim();
				var currentCollege = $("#info-college").text().trim();
				var currentMajor = $("#info-major").text().trim();
				
				var hasChange = formData.name !== currentName ||
				               formData.sex !== currentSex ||
				               formData.college !== currentCollege ||
				               formData.major !== currentMajor;
				
				if (!hasChange) {
					showNotification("æ²¡æœ‰ä¿®æ”¹ä»»ä½•ä¿¡æ¯", "info");
					return;
				}

				// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
				var submitBtn = $("#submit-edit-btn");
				if (!submitBtn || submitBtn.length === 0) {
					console.error("[ERROR] æ‰¾ä¸åˆ°æäº¤æŒ‰é’®");
					showNotification("é¡µé¢å…ƒç´ é”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•", "error");
					return;
				}
				
				// ä½¿ç”¨å…¼å®¹çš„æ–¹æ³•ï¼šattr æ›¿ä»£ propï¼ˆå…¼å®¹æ—§ç‰ˆ jQueryï¼‰
				submitBtn.attr("disabled", "disabled").text("ä¿å­˜ä¸­...");

				console.log("[DEBUG] æäº¤æ•°æ®:", formData);
				
				$.ajax({
					url: "/api/update_personal_info",
					type: "POST",
					contentType: "application/json",
					data: JSON.stringify(formData),
					success: function(res) {
						console.log("[DEBUG] æœåŠ¡å™¨å“åº”:", res);
						if (res.success) {
							// æ›´æ–°é¡µé¢æ˜¾ç¤º
							$("#info-name").text(formData.name);
							$("#info-sex").text(formData.sex);
							$("#info-college").text(formData.college);
							$("#info-major").text(formData.major);
							
							// æ›´æ–°ä¾§è¾¹æ 
							$("#sidebar-user-name").text(formData.name);
							
							// å…³é—­æ¨¡æ€æ¡†
							$("#edit-modal").fadeOut(200);
							
							// æ˜¾ç¤ºæˆåŠŸæç¤º
							showNotification("ä¸ªäººä¿¡æ¯æ›´æ–°æˆåŠŸï¼", "success");
						} else {
							var errorMsg = res.message || "æœªçŸ¥é”™è¯¯";
							console.error("[ERROR] æ›´æ–°å¤±è´¥:", errorMsg);
							showNotification("æ›´æ–°å¤±è´¥ï¼š" + errorMsg, "error");
						}
					},
					error: function(xhr, status, error) {
						console.error("[ERROR] AJAXè¯·æ±‚å¤±è´¥:", {
							status: xhr.status,
							statusText: xhr.statusText,
							responseText: xhr.responseText,
							error: error
						});
						
						var errorMsg = "æ›´æ–°å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
						if (xhr.responseJSON && xhr.responseJSON.message) {
							errorMsg = xhr.responseJSON.message;
						} else if (xhr.status === 401) {
							errorMsg = "ç”¨æˆ·æœªç™»å½•ï¼Œè¯·é‡æ–°ç™»å½•";
						} else if (xhr.status === 400) {
							errorMsg = "è¯·æ±‚å‚æ•°é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥";
						} else if (xhr.status === 500) {
							errorMsg = "æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•";
						} else if (xhr.status === 0) {
							errorMsg = "ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ";
						}
						showNotification(errorMsg, "error");
					},
					complete: function() {
						// ä½¿ç”¨é€‰æ‹©å™¨é‡æ–°è·å–æŒ‰é’®ï¼Œç¡®ä¿åœ¨ä½œç”¨åŸŸå†…
						// ä½¿ç”¨å…¼å®¹çš„æ–¹æ³•ï¼šremoveAttr æ›¿ä»£ propï¼ˆå…¼å®¹æ—§ç‰ˆ jQueryï¼‰
						$("#submit-edit-btn").removeAttr("disabled").text("ä¿å­˜");
					}
				});
			});

			// å¤´åƒé¢„è§ˆ
			$("#avatar-input").change(function(e) {
				var file = e.target.files[0];
				if (file) {
					// æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆ2MBï¼‰
					if (file.size > 2 * 1024 * 1024) {
						alert("æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡ 2MB");
						$(this).val("");
						return;
					}

					// æ£€æŸ¥æ–‡ä»¶ç±»å‹
					if (!file.type.match('image.*')) {
						alert("è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶");
						$(this).val("");
						return;
					}

					// é¢„è§ˆå›¾ç‰‡
					var reader = new FileReader();
					reader.onload = function(e) {
						$("#preview-img").attr("src", e.target.result);
						$("#upload-avatar-btn").removeAttr("disabled");
					};
					reader.readAsDataURL(file);
				}
			});

			// ä¸Šä¼ å¤´åƒ
			$("#upload-avatar-btn").click(function() {
				var fileInput = $("#avatar-input")[0];
				if (!fileInput.files || !fileInput.files[0]) {
					alert("è¯·å…ˆé€‰æ‹©å›¾ç‰‡");
					return;
				}

				var formData = new FormData();
				formData.append('avatar', fileInput.files[0]);

				// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
				$("#upload-avatar-btn").attr("disabled", "disabled").text("ä¸Šä¼ ä¸­...");

				$.ajax({
					url: "/api/upload_avatar",
					type: "POST",
					data: formData,
					processData: false,
					contentType: false,
					success: function(res) {
						if (res.success) {
							// æ›´æ–°æ‰€æœ‰å¤´åƒæ˜¾ç¤º
							var newAvatarUrl = res.avatar_url;
							$("#user-avatar, #info-avatar").attr("src", newAvatarUrl);
							$("#preview-img").attr("src", newAvatarUrl);
							
							// å…³é—­æ¨¡æ€æ¡†
							$("#avatar-modal").fadeOut(200);
							$("#avatar-input").val("");
							$("#upload-avatar-btn").attr("disabled", "disabled");
							
							// æ˜¾ç¤ºæˆåŠŸæç¤º
							showNotification("å¤´åƒä¸Šä¼ æˆåŠŸï¼", "success");
						} else {
							alert("ä¸Šä¼ å¤±è´¥ï¼š" + res.message);
						}
					},
					error: function(xhr) {
						var errorMsg = "ä¸Šä¼ å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
						if (xhr.responseJSON && xhr.responseJSON.message) {
							errorMsg = xhr.responseJSON.message;
						}
						alert(errorMsg);
					},
					complete: function() {
						$("#upload-avatar-btn").removeAttr("disabled").text("ä¸Šä¼ ");
					}
				});
			});

			// åŠ è½½è¯¾ç¨‹è®°å½•
			function loadCourseRecords() {
				$.ajax({
					url: "/api/get_course_records",
					type: "GET",
					success: function(res) {
						if (res.success && res.data) {
							let records = res.data;
							let html = '';
							
							if (records.length > 0) {
								html = '<table class="course_records_table"><thead><tr><th>è¯¾ç¨‹ç¼–å·</th><th>è¯¾ç¨‹åç§°</th><th>åˆ†ç±»</th><th>å­¦åˆ†</th><th>æˆè¯¾æ•™å¸ˆ</th><th>æˆç»©</th><th>è¯„ä»·</th><th>æ—¶é—´</th></tr></thead><tbody>';
								
								records.forEach(function(record) {
									html += `
										<tr>
											<td>${record.co_no}</td>
											<td>${record.co_name}</td>
											<td>${record.classification || 'æœªåˆ†ç±»'}</td>
											<td>${record.credits}</td>
											<td>${record.teacher}</td>
											<td><span class="grade_badge ${record.grade === 'æœªè¯„åˆ†' ? 'grade_pending' : 'grade_complete'}">${record.grade}</span></td>
											<td>${record.comment}</td>
											<td>${record.start_time || 'æœªçŸ¥'}</td>
										</tr>
									`;
								});
								
								html += '</tbody></table>';
							} else {
								html = '<div class="empty_state">æš‚æ— è¯¾ç¨‹è®°å½•</div>';
							}
							
							$("#course-records-content").html(html);
						} else {
							$("#course-records-content").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
						}
					},
					error: function() {
						$("#course-records-content").html('<div class="error">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>');
					}
				});
			}

			// ä¿®æ”¹å¯†ç è¡¨å•æäº¤
			$("#change-password-form").submit(function(e) {
				e.preventDefault();
				
				var oldPassword = $("#old-password").val();
				var newPassword = $("#new-password").val();
				var confirmPassword = $("#confirm-password").val();
				
				// éªŒè¯
				if (newPassword !== confirmPassword) {
					showNotification("ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´", "error");
					return;
				}
				
				if (newPassword.length < 6) {
					showNotification("æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½", "error");
					return;
				}
				
				// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
				var submitBtn = $(this).find("button[type='submit']");
				submitBtn.attr("disabled", "disabled").text("ä¿®æ”¹ä¸­...");
				
				$.ajax({
					url: "/api/change_password",
					type: "POST",
					contentType: "application/json",
					data: JSON.stringify({
						old_password: oldPassword,
						new_password: newPassword,
						confirm_password: confirmPassword
					}),
					success: function(res) {
						if (res.success) {
							showNotification("å¯†ç ä¿®æ”¹æˆåŠŸ", "success");
							$("#change-password-form")[0].reset();
						} else {
							showNotification(res.message || "ä¿®æ”¹å¤±è´¥", "error");
						}
					},
					error: function(xhr) {
						var errorMsg = "ä¿®æ”¹å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";
						if (xhr.responseJSON && xhr.responseJSON.message) {
							errorMsg = xhr.responseJSON.message;
						}
						showNotification(errorMsg, "error");
					},
					complete: function() {
						submitBtn.removeAttr("disabled").text("ä¿®æ”¹å¯†ç ");
					}
				});
			});

			// ä¿å­˜ç³»ç»Ÿè®¾ç½®
			$("#save-settings-btn").click(function() {
				var settings = {
					course_notify: $("#course-notify").is(":checked"),
					system_notify: $("#system-notify").is(":checked"),
					theme: $("#theme-select").val(),
					language: $("#language-select").val(),
					auto_save: $("#auto-save").is(":checked")
				};
				
				// ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
				localStorage.setItem('user_settings', JSON.stringify(settings));
				showNotification("è®¾ç½®å·²ä¿å­˜", "success");
			});

			// æ¢å¤é»˜è®¤è®¾ç½®
			$("#reset-settings-btn").click(function() {
				if (confirm("ç¡®å®šè¦æ¢å¤é»˜è®¤è®¾ç½®å—ï¼Ÿ")) {
					$("#course-notify, #system-notify, #auto-save").attr("checked", "checked");
					$("#theme-select").val("light");
					$("#language-select").val("zh");
					localStorage.removeItem('user_settings');
					showNotification("å·²æ¢å¤é»˜è®¤è®¾ç½®", "success");
				}
			});

			// åŠ è½½ä¿å­˜çš„è®¾ç½®
			var savedSettings = localStorage.getItem('user_settings');
			if (savedSettings) {
				try {
					var settings = JSON.parse(savedSettings);
					if (settings.course_notify !== false) {
						$("#course-notify").attr("checked", "checked");
					} else {
						$("#course-notify").removeAttr("checked");
					}
					if (settings.system_notify !== false) {
						$("#system-notify").attr("checked", "checked");
					} else {
						$("#system-notify").removeAttr("checked");
					}
					if (settings.auto_save !== false) {
						$("#auto-save").attr("checked", "checked");
					} else {
						$("#auto-save").removeAttr("checked");
					}
					if (settings.theme) $("#theme-select").val(settings.theme);
					if (settings.language) $("#language-select").val(settings.language);
				} catch(e) {
					console.error("åŠ è½½è®¾ç½®å¤±è´¥", e);
				}
			}

			// å¦‚æœå½“å‰æ˜¯è¯¾ç¨‹è®°å½•é¡µé¢ï¼ŒåŠ è½½æ•°æ®
			{% if section == 'course_records' %}
			loadCourseRecords();
			{% endif %}

			// æ˜¾ç¤ºé€šçŸ¥å‡½æ•°
			function showNotification(message, type) {
				type = type || "info";
				var notification = $('<div class="notification notification-' + type + '">' + message + '</div>');
				$("body").append(notification);
				
				setTimeout(function() {
					notification.addClass("show");
				}, 10);
				
				setTimeout(function() {
					notification.removeClass("show");
					setTimeout(function() {
						notification.remove();
					}, 300);
				}, 3000);
			}

			// é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®
			loadLearningStatistics();
			loadSystemNotices();
			// å»¶è¿Ÿæ›´æ–°ä¾§è¾¹æ ä¿¡æ¯ï¼Œç¡®ä¿é¡µé¢æ•°æ®å·²åŠ è½½
			setTimeout(updateSidebarInfo, 100);
		});
	</script>

	<style>
		/* ä¸ªäººä¸­å¿ƒå®¹å™¨ */
		.personal_center_container {
			width: 1200px;
			margin: 30px auto;
			display: flex;
			gap: 20px;
			min-height: 600px;
		}

		/* å·¦ä¾§å¯¼èˆªæ  */
		.personal_sidebar {
			width: 240px;
			background: #fff;
			border-radius: 8px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			padding: 20px 0;
		}

		/* å¤´åƒåŒºåŸŸ */
		.avatar_section {
			padding: 20px;
			text-align: center;
			border-bottom: 1px solid #f0f0f0;
		}

		.avatar_wrapper {
			position: relative;
			display: inline-block;
			margin-bottom: 15px;
		}

		.avatar_wrapper img {
			width: 100px;
			height: 100px;
			border-radius: 50%;
			border: 3px solid #003d79;
			object-fit: cover;
		}

		.avatar_edit_icon {
			position: absolute;
			bottom: 0;
			right: 0;
			width: 32px;
			height: 32px;
			background: #003d79;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			font-size: 16px;
		}

		.sidebar_user_name {
			font-size: 18px;
			font-weight: bold;
			color: #333;
			margin-bottom: 5px;
		}

		.sidebar_user_id {
			font-size: 14px;
			color: #666;
		}

		/* èœå•åˆ—è¡¨ */
		.sidebar_menu {
			list-style: none;
			padding: 0;
			margin: 0;
		}

		.menu_item {
			margin: 0;
		}

		.menu_item a {
			display: flex;
			align-items: center;
			padding: 15px 20px;
			color: #666;
			text-decoration: none;
			transition: all 0.3s;
			border-left: 3px solid transparent;
		}

		.menu_item a:hover {
			background: #f5f7fa;
			color: #003d79;
		}

		.menu_item.active a {
			background: #f0f4ff;
			color: #003d79;
			border-left-color: #003d79;
			font-weight: 500;
		}

		.menu_icon {
			font-size: 20px;
			margin-right: 12px;
			width: 24px;
			text-align: center;
		}

		.menu_text {
			font-size: 15px;
		}

		/* å³ä¾§å†…å®¹åŒº */
		.personal_content {
			flex: 1;
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		/* å¡ç‰‡é€šç”¨æ ·å¼ */
		.info_card, .learning_status_card, .system_notices_card {
			background: #fff;
			border-radius: 8px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.1);
			overflow: hidden;
		}

		.card_header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 20px 24px;
			border-bottom: 1px solid #f0f0f0;
			background: linear-gradient(135deg, #003d79 0%, #0056b3 100%);
		}

		.card_title {
			font-size: 18px;
			font-weight: 600;
			color: #fff;
			margin: 0;
		}

		.edit_btn {
			background: rgba(255,255,255,0.2);
			color: #fff;
			border: 1px solid rgba(255,255,255,0.3);
			padding: 6px 16px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
			transition: all 0.3s;
		}

		.edit_btn:hover {
			background: rgba(255,255,255,0.3);
		}

		.card_body {
			padding: 24px;
		}

		/* ä¸ªäººä¿¡æ¯å¡ç‰‡ */
		.info_avatar_section {
			text-align: center;
			margin-bottom: 30px;
		}

		.info_avatar_section img {
			width: 120px;
			height: 120px;
			border-radius: 50%;
			border: 4px solid #003d79;
			object-fit: cover;
			margin-bottom: 15px;
		}

		.change_avatar_btn {
			background: #f5f7fa;
			color: #003d79;
			border: 1px solid #d0d7de;
			padding: 8px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
			transition: all 0.3s;
		}

		.change_avatar_btn:hover {
			background: #e8f0fe;
			border-color: #003d79;
		}

		.info_details {
			display: flex;
			flex-direction: column;
			gap: 20px;
		}

		.info_row {
			display: flex;
			gap: 30px;
		}

		.info_item {
			flex: 1;
			display: flex;
			align-items: center;
			padding: 15px;
			background: #f9fafb;
			border-radius: 6px;
			border-left: 4px solid #003d79;
		}

		.info_label {
			font-size: 14px;
			color: #666;
			width: 80px;
			font-weight: 500;
		}

		.info_value {
			font-size: 15px;
			color: #333;
			font-weight: 500;
		}

		/* å­¦ä¹ çŠ¶æ€æ¦‚è§ˆ */
		.statistics_grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 20px;
		}

		.stat_item {
			display: flex;
			align-items: center;
			padding: 20px;
			background: linear-gradient(135deg, #f5f7fa 0%, #ffffff 100%);
			border-radius: 8px;
			border: 1px solid #e8eaed;
			transition: all 0.3s;
		}

		.stat_item:hover {
			box-shadow: 0 4px 12px rgba(0,61,121,0.1);
			transform: translateY(-2px);
		}

		.stat_icon {
			font-size: 36px;
			margin-right: 15px;
		}

		.stat_content {
			flex: 1;
		}

		.stat_value {
			font-size: 28px;
			font-weight: bold;
			color: #003d79;
			margin-bottom: 5px;
		}

		.stat_label {
			font-size: 14px;
			color: #666;
		}

		.progress_item {
			grid-column: 1 / -1;
		}

		.progress_info {
			display: flex;
			justify-content: space-between;
			margin-bottom: 10px;
		}

		.progress_label {
			font-size: 14px;
			color: #666;
		}

		.progress_percentage {
			font-size: 18px;
			font-weight: bold;
			color: #003d79;
		}

		.progress_bar_container {
			width: 100%;
			height: 12px;
			background: #e8eaed;
			border-radius: 6px;
			overflow: hidden;
		}

		.progress_bar {
			height: 100%;
			background: linear-gradient(90deg, #003d79, #0056b3);
			border-radius: 6px;
			transition: width 0.5s ease;
		}

		/* ç³»ç»Ÿæé†’ */
		.notices_list {
			display: flex;
			flex-direction: column;
			gap: 15px;
		}

		.notice_item {
			display: flex;
			align-items: center;
			padding: 18px;
			border-radius: 8px;
			border-left: 4px solid;
			transition: all 0.3s;
		}

		.notice_warning {
			background: #fff7e6;
			border-left-color: #faad14;
		}

		.notice_info {
			background: #e6f7ff;
			border-left-color: #1890ff;
		}

		.notice_tip {
			background: #f6ffed;
			border-left-color: #52c41a;
		}

		.notice_success {
			background: #f6ffed;
			border-left-color: #52c41a;
		}

		.notice_icon {
			font-size: 24px;
			margin-right: 15px;
		}

		.notice_content {
			flex: 1;
		}

		.notice_title {
			font-size: 16px;
			font-weight: 600;
			color: #333;
			margin-bottom: 5px;
		}

		.notice_message {
			font-size: 14px;
			color: #666;
		}

		.notice_action {
			padding: 6px 16px;
			background: #003d79;
			color: #fff;
			border-radius: 4px;
			text-decoration: none;
			font-size: 14px;
			transition: all 0.3s;
		}

		.notice_action:hover {
			background: #0056b3;
		}

		.loading, .error {
			text-align: center;
			padding: 40px 0;
			color: #999;
		}

		.error {
			color: #f56c6c;
		}

		/* æ¨¡æ€æ¡†æ ·å¼ */
		.modal {
			display: none;
			position: fixed;
			z-index: 10000;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0,0,0,0.5);
			backdrop-filter: blur(2px);
		}

		.modal_content {
			background-color: #fff;
			margin: 5% auto;
			border-radius: 8px;
			width: 90%;
			max-width: 600px;
			box-shadow: 0 4px 20px rgba(0,0,0,0.3);
			animation: modalSlideIn 0.3s ease;
		}

		.modal_small {
			max-width: 400px;
		}

		@keyframes modalSlideIn {
			from {
				transform: translateY(-50px);
				opacity: 0;
			}
			to {
				transform: translateY(0);
				opacity: 1;
			}
		}

		.modal_header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 20px 24px;
			border-bottom: 1px solid #f0f0f0;
			background: linear-gradient(135deg, #003d79 0%, #0056b3 100%);
		}

		.modal_header h3 {
			margin: 0;
			font-size: 18px;
			font-weight: 600;
			color: #fff;
		}

		.modal_close {
			color: #fff;
			font-size: 28px;
			font-weight: bold;
			cursor: pointer;
			line-height: 1;
			transition: transform 0.2s;
		}

		.modal_close:hover {
			transform: rotate(90deg);
		}

		.modal_body {
			padding: 24px;
		}

		.modal_footer {
			padding: 16px 24px;
			border-top: 1px solid #f0f0f0;
			display: flex;
			justify-content: flex-end;
			gap: 12px;
		}

		/* è¡¨å•æ ·å¼ */
		.form_group {
			margin-bottom: 20px;
		}

		.form_group label {
			display: block;
			margin-bottom: 8px;
			font-size: 14px;
			font-weight: 500;
			color: #333;
		}

		.form_group input[type="text"],
		.form_group select {
			width: 100%;
			padding: 10px 12px;
			border: 1px solid #d0d7de;
			border-radius: 4px;
			font-size: 14px;
			transition: border-color 0.3s;
		}

		.form_group input[type="text"]:focus,
		.form_group select:focus {
			outline: none;
			border-color: #003d79;
			box-shadow: 0 0 0 3px rgba(0,61,121,0.1);
		}

		.form_group input[type="text"]:disabled {
			background: #f5f7fa;
			color: #666;
			cursor: not-allowed;
		}

		.form_hint {
			display: block;
			margin-top: 5px;
			font-size: 12px;
			color: #999;
		}

		/* æŒ‰é’®æ ·å¼ */
		.btn_cancel, .btn_submit, .btn_upload {
			padding: 10px 20px;
			border: none;
			border-radius: 4px;
			font-size: 14px;
			cursor: pointer;
			transition: all 0.3s;
		}

		.btn_cancel {
			background: #f5f7fa;
			color: #666;
		}

		.btn_cancel:hover {
			background: #e8eaed;
		}

		.btn_submit {
			background: #003d79;
			color: #fff;
		}

		.btn_submit:hover:not(:disabled) {
			background: #0056b3;
		}

		.btn_submit:disabled {
			background: #ccc;
			cursor: not-allowed;
		}

		.btn_upload {
			background: #f5f7fa;
			color: #003d79;
			border: 1px solid #d0d7de;
		}

		.btn_upload:hover {
			background: #e8f0fe;
			border-color: #003d79;
		}

		/* å¤´åƒä¸Šä¼ åŒºåŸŸ */
		.avatar_upload_area {
			text-align: center;
		}

		.avatar_preview {
			margin-bottom: 20px;
		}

		.avatar_preview img {
			width: 150px;
			height: 150px;
			border-radius: 50%;
			border: 4px solid #003d79;
			object-fit: cover;
		}

		.upload_actions {
			display: flex;
			justify-content: center;
			gap: 12px;
			margin-bottom: 10px;
		}

		.upload_hint {
			display: block;
			color: #999;
			font-size: 12px;
			margin-top: 10px;
		}

		/* å“åº”å¼è®¾è®¡ */
		@media (max-width: 1280px) {
			.personal_center_container {
				width: 95%;
				flex-direction: column;
			}

			.personal_sidebar {
				width: 100%;
			}

			.sidebar_menu {
				display: flex;
				overflow-x: auto;
			}

			.menu_item {
				flex-shrink: 0;
			}

			.statistics_grid {
				grid-template-columns: 1fr;
			}

			.modal_content {
				width: 95%;
				margin: 10% auto;
			}
		}

		/* é€šçŸ¥æç¤ºæ ·å¼ */
		.notification {
			position: fixed;
			top: 20px;
			right: 20px;
			padding: 15px 20px;
			border-radius: 6px;
			box-shadow: 0 4px 12px rgba(0,0,0,0.15);
			z-index: 10001;
			min-width: 250px;
			opacity: 0;
			transform: translateX(100%);
			transition: all 0.3s ease;
			font-size: 14px;
		}

		.notification.show {
			opacity: 1;
			transform: translateX(0);
		}

		.notification-success {
			background: #52c41a;
			color: #fff;
		}

		.notification-error {
			background: #f5222d;
			color: #fff;
		}

		.notification-info {
			background: #1890ff;
			color: #fff;
		}

		.notification-warning {
			background: #faad14;
			color: #fff;
		}

		/* è´¦å·å®‰å…¨é¡µé¢æ ·å¼ */
		.security_section {
			margin-bottom: 30px;
			padding-bottom: 30px;
			border-bottom: 1px solid #f0f0f0;
		}

		.security_section:last-child {
			border-bottom: none;
		}

		.section_subtitle {
			font-size: 16px;
			font-weight: 600;
			color: #333;
			margin-bottom: 20px;
		}

		.security_form {
			max-width: 500px;
		}

		.form_actions {
			margin-top: 20px;
		}

		.security_item, .setting_item {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 15px 0;
			border-bottom: 1px solid #f0f0f0;
		}

		.security_item:last-child, .setting_item:last-child {
			border-bottom: none;
		}

		.security_info, .setting_info {
			flex: 1;
		}

		.security_label, .setting_label {
			font-size: 15px;
			font-weight: 500;
			color: #333;
			margin-bottom: 5px;
		}

		.security_desc, .setting_desc {
			font-size: 13px;
			color: #999;
		}

		/* å¼€å…³æ ·å¼ */
		.switch {
			position: relative;
			display: inline-block;
			width: 50px;
			height: 26px;
		}

		.switch input {
			opacity: 0;
			width: 0;
			height: 0;
		}

		.slider {
			position: absolute;
			cursor: pointer;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: #ccc;
			transition: .4s;
			border-radius: 26px;
		}

		.slider:before {
			position: absolute;
			content: "";
			height: 20px;
			width: 20px;
			left: 3px;
			bottom: 3px;
			background-color: white;
			transition: .4s;
			border-radius: 50%;
		}

		input:checked + .slider {
			background-color: #003d79;
		}

		input:checked + .slider:before {
			transform: translateX(24px);
		}

		input:disabled + .slider {
			opacity: 0.6;
			cursor: not-allowed;
		}

		.status_badge {
			padding: 4px 12px;
			border-radius: 12px;
			font-size: 12px;
			font-weight: 500;
		}

		.status_success {
			background: #f0f9ff;
			color: #52c41a;
		}

		/* è¯¾ç¨‹è®°å½•è¡¨æ ¼æ ·å¼ */
		.course_records_table {
			width: 100%;
			border-collapse: collapse;
			margin-top: 10px;
		}

		.course_records_table th,
		.course_records_table td {
			padding: 12px;
			text-align: left;
			border-bottom: 1px solid #f0f0f0;
		}

		.course_records_table th {
			background: #f5f7fa;
			font-weight: 600;
			color: #333;
			font-size: 14px;
		}

		.course_records_table td {
			font-size: 14px;
			color: #666;
		}

		.course_records_table tr:hover {
			background: #f9fafb;
		}

		.grade_badge {
			padding: 4px 10px;
			border-radius: 4px;
			font-size: 12px;
			font-weight: 500;
		}

		.grade_complete {
			background: #f0f9ff;
			color: #003d79;
		}

		.grade_pending {
			background: #fff7e6;
			color: #faad14;
		}

		.empty_state {
			text-align: center;
			padding: 60px 20px;
			color: #999;
			font-size: 14px;
		}

		/* ç³»ç»Ÿè®¾ç½®æ ·å¼ */
		.settings_section {
			margin-bottom: 30px;
			padding-bottom: 30px;
			border-bottom: 1px solid #f0f0f0;
		}

		.settings_section:last-of-type {
			border-bottom: none;
		}

		.setting_select {
			padding: 8px 12px;
			border: 1px solid #d0d7de;
			border-radius: 4px;
			font-size: 14px;
			background: #fff;
			color: #333;
			cursor: pointer;
			min-width: 150px;
		}

		.setting_select:focus {
			outline: none;
			border-color: #003d79;
			box-shadow: 0 0 0 3px rgba(0,61,121,0.1);
		}

		.settings_actions {
			margin-top: 30px;
			display: flex;
			gap: 12px;
		}
	</style>
	</body>

</html>
